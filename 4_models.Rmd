---
title: "Modelling health as a functions of landscape metricts and fire effects"
author: "Julia Barreto"
date: "`r Sys.Date()`"
output:
  rmdformats::readthedown:
    highlight: kate
    thumbnails: false
    lightbox: true
    gallery: false
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(cache = F, message = F, warning = F, error= F)
library(here)
library(GGally)
library(ggplot2)
library(patchwork)
library(bbmle)
library(lme4)
library(skimr)
library(DHARMa)
library(ggeffects)
library(tidyverse)
library(cowplot)
theme_set(theme_cowplot())
library(car)
# library(sf)
# library(mapview)
# library(janitor)
```


# Data Loading and Preprocessing

```{r}
combined_data <- read.csv(here("data", "R2", "Bolivia.csv")) %>%
  bind_rows(read.csv(here("data", "R2", "Brasil.csv")),
            read.csv(here("data", "R2", "Colombia.csv")),
            read.csv(here("data", "R2", "Guiana FR.csv")),
            read.csv(here("data", "R2", "Ecuador.csv")),
            read.csv(here("data", "R2", "Peru.csv")),
            read.csv(here("data", "R2", "Suriname.csv")),
            read.csv(here("data", "R2", "Venezuela.csv"))
            )

# length(unique(combined_data$COD)) # 1733
summary(combined_data)
```


Data skimr and structure:
```{r}
skim(combined_data); str(combined_data)
```

## Predictors expl.

```{r, warning= FALSE, fig.height=12, fig.width=12}
### cor predictors
ggpairs(combined_data, 
                columns = c("for_PLAND", "for_PD", "for_ED",
                            "for_ENN_MN", "for_AI", "tot_IT",
                            "NOTackn_IT", "acknlgd_IT", 
                            "pm25_SUM", "fire_SUM"),
                upper = list(continuous = "cor"),  # Show correlation coefficients
                lower = list(continuous = "points"))
```

### Collinearity landscape and fire

When additive:
```{r}
m <- lm(health ~ for_PLAND + pm25_SUM, data = combined_data)
car::vif(m)
```
Interactive (*):
```{r}
m <- lm(health ~ for_PLAND*pm25_SUM, data = combined_data)
car::vif(m, type="predictor")
```

### Fire polluttants ~ landscape?
```{r}
m <- lm(pm25_SUM ~ for_PLAND, data = combined_data)
m0 <- lm(pm25_SUM ~ 1, data = combined_data)

bbmle::AICtab(m0, m, base= TRUE, weights= TRUE)
```

### Fire amount ~ fire polluttants?
```{r}
m <- lm(pm25_SUM ~ fire_SUM, data = combined_data)
m0 <- lm(pm25_SUM ~ 1, data = combined_data)

bbmle::AICtab(m0, m, base= TRUE, weights= TRUE)
```

### Forest outside ITs:

Q) Query Paula, brainstorm about negative values, treat for 0?
```{r}
# subraction removing NA
combined_data$for_noIT <- 
  (ifelse(is.na(combined_data$for_PLAND), NA, combined_data$for_PLAND) -
     ifelse(is.na(combined_data$tot_IT), 0, combined_data$tot_IT))

summary(combined_data$for_noIT)
```



# VR distribution

Boxplot Visualization = show you the distribution of disease cases for each country across different years, using boxplots. And, alternatively histogram to see the frequency distribution of cases, histograms can be helpful.

```{r, eval= FALSE}
ggplot(combined_data, aes(x = year, y = health, fill = country)) +
  geom_boxplot() +
  labs(title = "Distribution of Disease Cases per Country and Year",
       x = "Year",
       y = "Number of Disease Cases") +
  facet_wrap(~country, scales = "free_x") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none")
```


```{r}
# Plotting the distribution of health cases using histograms
ggplot(combined_data, aes(x = health, fill = country)) +
  geom_histogram(bins = 30, alpha = 0.6, position = "identity") +
  labs(title = "Histogram of number of health aspects cases per Country",
       x = "Number of Disease Cases",
       y = "Frequency") +
  facet_wrap(~country, scales = "free") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none")
```


# Modelling

Prepare data, by scaling predictors:
```{r}
combined_data.s <- combined_data %>% 
  mutate_at(27:41, scale)
```

## Linear models

### Health in general
```{r}
## BROAD GLOBAL HEALTH MOD

# absence of effect
m0 <- lm(health ~ 1, data = combined_data.s) 

# landscape
m1 <- lm(health ~ for_PLAND, data = combined_data.s)
m2 <- lm(health ~ for_PD, data = combined_data.s)
m3 <- lm(health ~ for_ED, data = combined_data.s)
m4 <- lm(health ~ for_ENN_MN, data = combined_data.s) 
m5<- lm(health ~ for_AI, data = combined_data.s)

# forest outside IT
m6<- lm(health ~ for_noIT, data = combined_data.s)

#TI
m7<-lm(health ~ tot_IT, data = combined_data.s)
m8 <- lm(health ~ NOTackn_IT, data = combined_data.s)
m9 <- lm(health ~ acknlgd_IT, data = combined_data.s)

# fire
m10 <- lm(health ~ pm25_SUM, data = combined_data.s)
m11 <- lm(health ~ fire_SUM, data = combined_data.s)

# landscape and fire
m12 <- lm(health ~ for_PLAND + pm25_SUM, data = combined_data.s)

bbmle::AICtab(m0, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, 
              m12,
       base= TRUE, weights= TRUE)
```


```{r}
summary(m12)
```

Check residuals
```{r}
plotSimulatedResiduals(m12)
```

```{r}
testOverdispersion(m12)
```


Plot predictions:
```{r}
ggpredict(m12, terms = c("for_PLAND", "pm25_SUM")) %>% ggplot(aes(x = x, y = predicted, color = group)) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high), alpha = 0.2) +
  labs(
    title = "Predicted Health effects from landscape and fire",
    x = "Forest PLAND",
    y = "Predicted Health",
    color = "PM 2.5"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10)
  )
```
Alternatively (with facets):
```{r}
ggpredict(m12, terms = c("for_PLAND", "pm25_SUM")) %>%
ggplot(aes(x = x, y = predicted)) +
  geom_line(aes(color = group), size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = group), alpha = 0.2) +
  labs(
       title = "Predicted Health effects from landscape and fire",
    x = "Forest PLAND",
    y = "Health",
    color = "PM 2.5",
    fill = "PM 2.5"
  ) +
  facet_wrap(~group) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10)
  )

```


### Zoonotic

```{r}
# absence of effect
m0 <- lm(zoonotic ~ 1, data = combined_data.s) 

# landscape
m1 <- lm(zoonotic ~ for_PLAND, data = combined_data.s)
m2 <- lm(zoonotic ~ for_PD, data = combined_data.s)
m3 <- lm(zoonotic ~ for_ED, data = combined_data.s)
m4 <- lm(zoonotic ~ for_ENN_MN, data = combined_data.s) 
m5<- lm(zoonotic ~ for_AI, data = combined_data.s)

# forest outside IT
m6<- lm(zoonotic ~ for_noIT, data = combined_data.s)

#TI
m7<-lm(zoonotic ~ tot_IT, data = combined_data.s)
m8 <- lm(zoonotic ~ NOTackn_IT, data = combined_data.s)
m9 <- lm(zoonotic ~ acknlgd_IT, data = combined_data.s)

# fire
m10 <- lm(zoonotic ~ pm25_SUM, data = combined_data.s)
m11 <- lm(zoonotic ~ fire_SUM, data = combined_data.s)

# landscape and fire
m12 <- lm(zoonotic ~ for_PLAND + pm25_SUM, data = combined_data.s)

bbmle::AICtab(m0, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, 
              m12,
       base= TRUE, weights= TRUE)
```


```{r}
summary(m12)
```

Check residuals
```{r}
DHARMa::plotSimulatedResiduals(m12)
```

```{r}
testOverdispersion(m12)
```


Plot predictions:
```{r}
ggpredict(m12, terms = c("for_PLAND", "pm25_SUM")) %>% ggplot(aes(x = x, y = predicted, color = group)) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high), alpha = 0.2) +
  labs(
    title = "Predicted Zoonotic effects from landscape and fire",
    x = "Forest PLAND",
    y = "Zoonotic",
    color = "PM 2.5"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10)
  )
```
Alternatively (with facets):
```{r}
ggpredict(m12, terms = c("for_PLAND", "pm25_SUM")) %>%
ggplot(aes(x = x, y = predicted)) +
  geom_line(aes(color = group), size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = group), alpha = 0.2) +
  labs(
       title = "Predicted Health effects to landscape and fire",
    x = "Forest PLAND",
    y = "Predicted Health",
    color = "PM 2.5",
    fill = "PM 2.5"
  ) +
  facet_wrap(~group) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10)
  )

```

### Fire-related

```{r}
# absence of effect
m0 <- lm(fire_related ~ 1, data = combined_data.s) 

# landscape
m1 <- lm(fire_related ~ for_PLAND, data = combined_data.s)
m2 <- lm(fire_related ~ for_PD, data = combined_data.s)
m3 <- lm(fire_related ~ for_ED, data = combined_data.s)
m4 <- lm(fire_related ~ for_ENN_MN, data = combined_data.s) 
m5<- lm(fire_related ~ for_AI, data = combined_data.s)

# forest outside IT
m6<- lm(fire_related ~ for_noIT, data = combined_data.s)

#TI
m7<-lm(fire_related ~ tot_IT, data = combined_data.s)
m8 <- lm(fire_related ~ NOTackn_IT, data = combined_data.s)
m9 <- lm(fire_related ~ acknlgd_IT, data = combined_data.s)

# fire
m10 <- lm(fire_related ~ pm25_SUM, data = combined_data.s)
m11 <- lm(fire_related ~ fire_SUM, data = combined_data.s)

# landscape and fire
m12 <- lm(fire_related ~ for_PLAND + pm25_SUM, data = combined_data.s)

bbmle::AICtab(m0, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, 
              m12,
       base= TRUE, weights= TRUE)
```


```{r}
summary(m12)
```

Check residuals
```{r}
DHARMa::plotSimulatedResiduals(m12)
```

```{r}
testOverdispersion(m12)
```


Plot predictions:
```{r}
ggpredict(m12, terms = c("for_PLAND", "pm25_SUM")) %>% ggplot(aes(x = x, y = predicted, color = group)) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high), alpha = 0.2) +
  labs(
    title = "Predicted Fire-related diseases effects from landscape and fire",
    x = "Forest PLAND",
    y = "Fire-related diseases",
    color = "PM 2.5"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10)
  )
```
Alternatively (with facets):
```{r}
ggpredict(m12, terms = c("for_PLAND", "pm25_SUM")) %>%
ggplot(aes(x = x, y = predicted)) +
  geom_line(aes(color = group), size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = group), alpha = 0.2) +
  labs(
       title = "Predicted Fire-related diseases effects from landscape and fire",
    x = "Forest PLAND",
    y = "Fire-related diseases",
    color = "PM 2.5",
    fill = "PM 2.5"
  ) +
  facet_wrap(~group) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10)
  )

```

### Respiratory (fire-related)

```{r}
# absence of effect
m0 <- lm(respiratory ~ 1, data = combined_data.s) 

# landscape
m1 <- lm(respiratory ~ for_PLAND, data = combined_data.s)
m2 <- lm(respiratory ~ for_PD, data = combined_data.s)
m3 <- lm(respiratory ~ for_ED, data = combined_data.s)
m4 <- lm(respiratory ~ for_ENN_MN, data = combined_data.s) 
m5<- lm(respiratory ~ for_AI, data = combined_data.s)

# forest outside IT
m6<- lm(respiratory ~ for_noIT, data = combined_data.s)

#TI
m7<-lm(respiratory ~ tot_IT, data = combined_data.s)
m8 <- lm(respiratory ~ NOTackn_IT, data = combined_data.s)
m9 <- lm(respiratory ~ acknlgd_IT, data = combined_data.s)

# fire
m10 <- lm(respiratory ~ pm25_SUM, data = combined_data.s)
m11 <- lm(respiratory ~ fire_SUM, data = combined_data.s)

# landscape and fire
m12 <- lm(respiratory ~ for_PLAND + pm25_SUM, data = combined_data.s)

bbmle::AICtab(m0, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, 
              m12,
       base= TRUE, weights= TRUE)
```


```{r}
summary(m12)
```

Check residuals
```{r}
DHARMa::plotSimulatedResiduals(m12)
```

```{r}
testOverdispersion(m12)
```


Plot predictions:
```{r}
ggpredict(m12, terms = c("for_PLAND", "pm25_SUM")) %>% ggplot(aes(x = x, y = predicted, color = group)) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high), alpha = 0.2) +
  labs(
    title = "Predicted FR respiratoty diseases effects from landscape and fire",
    x = "Forest PLAND",
    y = "Respiratory diseases",
    color = "PM 2.5"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10)
  )
```
Alternatively (with facets):
```{r}
ggpredict(m12, terms = c("for_PLAND", "pm25_SUM")) %>%
ggplot(aes(x = x, y = predicted)) +
  geom_line(aes(color = group), size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = group), alpha = 0.2) +
  labs(
       title = "Predicted FR respiratoty diseases effects from landscape and fire",
    x = "Forest PLAND",
    y = "Respiratoty diseases",
    color = "PM 2.5",
    fill = "PM 2.5"
  ) +
  facet_wrap(~group) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10)
  )

```

### Cardiovascular (fire-related)

```{r}
# absence of effect
m0 <- lm(cardiovascular ~ 1, data = combined_data.s) 

# landscape
m1 <- lm(cardiovascular ~ for_PLAND, data = combined_data.s)
m2 <- lm(cardiovascular ~ for_PD, data = combined_data.s)
m3 <- lm(cardiovascular ~ for_ED, data = combined_data.s)
m4 <- lm(cardiovascular ~ for_ENN_MN, data = combined_data.s) 
m5<- lm(cardiovascular ~ for_AI, data = combined_data.s)

# forest outside IT
m6<- lm(cardiovascular ~ for_noIT, data = combined_data.s)

#TI
m7<-lm(cardiovascular ~ tot_IT, data = combined_data.s)
m8 <- lm(cardiovascular ~ NOTackn_IT, data = combined_data.s)
m9 <- lm(cardiovascular ~ acknlgd_IT, data = combined_data.s)

# fire
m10 <- lm(cardiovascular ~ pm25_SUM, data = combined_data.s)
m11 <- lm(cardiovascular ~ fire_SUM, data = combined_data.s)

# landscape and fire
m12 <- lm(cardiovascular ~ for_PLAND + pm25_SUM, data = combined_data.s)

bbmle::AICtab(m0, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, 
              m12,
       base= TRUE, weights= TRUE)
```


```{r}
summary(m9)
```

Check residuals
```{r}
DHARMa::plotSimulatedResiduals(m9)
```

```{r}
testOverdispersion(m9)
```
Plot predictions:
<!-- Something weird that predictor wont run -->
<!-- ```{r} -->
<!-- ggpredict(m9, terms = "acknlgd_IT") %>% -->
<!--   ggplot(predictions, aes(x = x, y = predicted)) + -->
<!--   geom_line(color = "darkgoldenrod", size = 1) + -->
<!--   geom_ribbon(aes(ymin = conf.low, ymax = conf.high), fill = "darkgoldenrod", alpha = 0.2) + -->
<!--   labs( -->
<!--     title = "Predicted Disease Incidence by Acknowledged IT", -->
<!--     x = "Acknowledged IT", -->
<!--     y = "Predicted Incidence (per 100,000)" -->
<!--   ) + -->
<!--   theme_minimal() + -->
<!--   theme( -->
<!--     plot.title = element_text(hjust = 0.5, size = 14), -->
<!--     axis.title.x = element_text(size = 12), -->
<!--     axis.title.y = element_text(size = 12) -->
<!--   ) -->
<!-- ``` -->



### Acute (fire-related)

```{r}
# absence of effect
m0 <- lm(acute ~ 1, data = combined_data.s) 

# landscape
m1 <- lm(acute ~ for_PLAND, data = combined_data.s)
m2 <- lm(acute ~ for_PD, data = combined_data.s)
m3 <- lm(acute ~ for_ED, data = combined_data.s)
m4 <- lm(acute ~ for_ENN_MN, data = combined_data.s) 
m5<- lm(acute ~ for_AI, data = combined_data.s)

# forest outside IT
m6<- lm(acute ~ for_noIT, data = combined_data.s)

#TI
m7<-lm(acute ~ tot_IT, data = combined_data.s)
m8 <- lm(acute ~ NOTackn_IT, data = combined_data.s)
m9 <- lm(acute ~ acknlgd_IT, data = combined_data.s)

# fire
m10 <- lm(acute ~ pm25_SUM, data = combined_data.s)
m11 <- lm(acute ~ fire_SUM, data = combined_data.s)

# landscape and fire
m12 <- lm(acute ~ for_PLAND + pm25_SUM, data = combined_data.s)

bbmle::AICtab(m0, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, 
              m12,
       base= TRUE, weights= TRUE)
```


```{r}
summary(m4)
```

Check residuals
```{r}
DHARMa::plotSimulatedResiduals(m4)
```

```{r}
testOverdispersion(m4)
```


Plot predictions:

```{r}
ggpredict(m4, terms = "for_ENN_MN") %>%
  ggplot(aes(x = x, y = predicted)) +
  geom_line(color = "darkred", size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high), fill = "darkred", alpha = 0.2) +
  labs(
    title = "Predicted Acute disease by Forest ENN_MN",
    x = "Forest mean Euclidean distance",
    y = "Predicted Acute"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12)
  )
```


## Incidence models

```{r}
# Absence of Effect Model:
m0 <- lm((health/pop) * 100000 ~ 1, data = combined_data.s)

# Landscape Models:
m1 <- lm((health/pop) * 100000 ~ for_PLAND, data = combined_data.s)
m2 <- lm((health/pop) * 100000 ~ for_PD, data = combined_data.s)
m3 <- lm((health/pop) * 100000 ~ for_ED, data = combined_data.s)
m4 <- lm((health/pop) * 100000 ~ for_ENN_MN, data = combined_data.s)
m5 <- lm((health/pop) * 100000 ~ for_AI, data = combined_data.s)

# Forest Outside IT:
m6 <- lm((health/pop) * 100000 ~ for_noIT, data = combined_data.s)

# TI Models:
m7 <- lm((health/pop) * 100000 ~ tot_IT, data = combined_data.s)
m8 <- lm((health/pop) * 100000 ~ NOTackn_IT, data = combined_data.s)
m9 <- lm((health/pop) * 100000 ~ acknlgd_IT, data = combined_data.s)

# Fire Models:
m10 <- lm((health/pop) * 100000 ~ pm25_SUM, data = combined_data.s)
m11 <- lm((health/pop) * 100000 ~ fire_SUM, data = combined_data.s)

# Landscape and Fire Interaction Models:
m12 <- lm((health/pop) * 100000 ~ for_PLAND + fire_SUM, data = combined_data.s)


# Compare Models Using AIC:
bbmle::AICtab(m0, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11,
              m12,base = TRUE, weights= TRUE)
```

```{r}
summary(m4)
```

Check residuals
```{r}
plotSimulatedResiduals(m4)
```


Plot predictions:

```{r}
ggpredict(m4, terms = "for_ENN_MN") %>%
  ggplot(aes(x = x, y = predicted)) +
  geom_line(color = "darkgreen", size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high), fill = "darkgreen", alpha = 0.2) +
  labs(
    title = "Predicted Disease Incidence by Forest ENN_MN",
    x = "Forest mean Euclidean distance",
    y = "Predicted Incidence (per 100,000)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12)
  )
```


# Mixed models

```{r}
# Null Model:
m0 <- glmer(health ~ 1 + (1 | country), data = combined_data.s, family = poisson)

# Landscape Models:
m1 <- glmer(health ~ for_PLAND + (1 | country), data = combined_data.s, family = poisson)
m2 <- glmer(health ~ for_PD + (1 | country), data = combined_data.s, family = poisson)
m3 <- glmer(health ~ for_ED + (1 | country), data = combined_data.s, family = poisson)
m4 <- glmer(health ~ for_ENN_MN + (1 | country), data = combined_data.s, family = poisson)
m5 <- glmer(health ~ for_AI + (1 | country), data = combined_data.s, family = poisson)

# Forest Outside IT:
m6 <- glmer(health ~ for_noIT + (1 | country), data = combined_data.s, family = poisson)

# TI Models:
m7 <- glmer(health ~ tot_IT + (1 | country), data = combined_data.s, family = poisson)
m8 <- glmer(health ~ NOTackn_IT + (1 | country), data = combined_data.s, family = poisson)
m9 <- glmer(health ~ acknlgd_IT + (1 | country), data = combined_data.s, family = poisson)

# Fire Models:
m10 <- glmer(health ~ pm25_SUM + (1 | country), data = combined_data.s, family = poisson)
m11 <- glmer(health ~ fire_SUM + (1 | country), data = combined_data.s, family = poisson)

# Landscape and Fire Interaction Models:
m12 <- glmer(health ~ for_PLAND + pm25_SUM + (1 | country), data = combined_data.s, family = poisson)

# Compare Models Using AIC
bbmle::AICtab(m0, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,base = TRUE, weights = TRUE)
```

```{r}
# Null Model:
m0 <- glmer((health/pop) * 100000 ~ 1 + (1 | country), data = combined_data.s, family = poisson)

# Landscape Models:
m1 <- glmer((health/pop) * 100000 ~ for_PLAND + (1 | country), data = combined_data.s, family = poisson)
m2 <- glmer((health/pop) * 100000 ~ for_PD + (1 | country), data = combined_data.s, family = poisson)
m3 <- glmer((health/pop) * 100000 ~ for_ED + (1 | country), data = combined_data.s, family = poisson)
m4 <- glmer((health/pop) * 100000 ~ for_ENN_MN + (1 | country), data = combined_data.s, family = poisson)
m5 <- glmer((health/pop) * 100000 ~ for_AI + (1 | country), data = combined_data.s, family = poisson)

# Forest Outside IT:
m6 <- glmer((health/pop) * 100000 ~ for_noIT + (1 | country), data = combined_data.s, family = poisson)

# TI Models:
m7 <- glmer((health/pop) * 100000 ~ tot_IT + (1 | country), data = combined_data.s, family = poisson)
m8 <- glmer((health/pop) * 100000 ~ NOTackn_IT + (1 | country), data = combined_data.s, family = poisson)
m9 <- glmer((health/pop) * 100000 ~ acknlgd_IT + (1 | country), data = combined_data.s, family = poisson)

# Fire Models:
m10 <- glmer((health/pop) * 100000 ~ pm25_SUM + (1 | country), data = combined_data.s, family = poisson)
m11 <- glmer((health/pop) * 100000 ~ fire_SUM + (1 | country), data = combined_data.s, family = poisson)

# Landscape and Fire Interaction Models:
m12 <- glmer((health/pop) * 100000 ~ for_PLAND + fire_SUM + (1 | country), data = combined_data.s, family = poisson)

# Compare Models Using AIC
bbmle::AICtab(m0, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,base = TRUE, weights = TRUE)
```

